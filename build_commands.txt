# PyInstaller 打包命令说明

## 方法一：使用自动化打包脚本（推荐）

```bash
python build_exe.py
```

这个脚本会：
1. 自动检查并安装PyInstaller
2. 生成优化的打包参数
3. 执行打包过程
4. 创建便携版压缩包

## 方法二：使用.spec文件打包

```bash
pyinstaller build.spec
```

## 方法三：直接使用命令行参数

```bash
pyinstaller --onefile --windowed --name "文件处理工具" ^
    --add-data "config.json;." ^
    --add-data "config_example.json;." ^
    --add-data "tools_config.ini;." ^
    --add-data "README.md;." ^
    --add-data "tools;tools" ^
    --hidden-import "tkinterdnd2" ^
    --hidden-import "tkinterdnd2.tkdnd" ^
    --hidden-import "PIL" ^
    --hidden-import "PIL.Image" ^
    --hidden-import "PIL.ImageTk" ^
    --hidden-import "requests" ^
    --exclude-module "matplotlib" ^
    --exclude-module "numpy" ^
    --exclude-module "scipy" ^
    --exclude-module "pandas" ^
    main.py
```

## 打包参数说明

- `--onefile`: 打包成单个可执行文件
- `--windowed`: Windows下隐藏控制台窗口
- `--name <name>`: 指定输出文件名
- `--add-data <src;dst>`: 添加数据文件
- `--hidden-import <module>`: 添加隐藏导入
- `--exclude-module <module>`: 排除不需要的模块
- `--icon <icon.ico>`: 指定程序图标（如果有）

## 注意事项

1. **打包前请确保**：
   - 已安装所有依赖项：`pip install -r requirements.txt`
   - tools目录中包含所需的7z.exe和ffmpeg.exe
   - 配置文件完整且有效

2. **打包后测试**：
   - 在目标系统上测试可执行文件
   - 检查工具路径是否正确
   - 验证所有功能是否正常工作

3. **文件大小优化**：
   - 使用UPX压缩（已包含在参数中）
   - 排除不需要的Python模块
   - 考虑使用虚拟环境进行打包

4. **常见问题**：
   - 如果提示找不到模块，添加 `--hidden-import` 参数
   - 如果打包失败，尝试使用 `--clean` 参数清理缓存
   - 确保所有数据文件路径正确

## 便携版创建

打包完成后，运行 `create_portable.py` 创建包含所有必需文件的便携版：

```bash
python create_portable.py
```

这将创建一个包含可执行文件、配置文件和说明文档的目录，方便分发和使用。