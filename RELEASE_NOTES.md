# 文件处理工具 - 发布说明

## 版本信息
- 版本：v2.0
- 打包时间：2026-02-24
- 文件大小：约137MB
- 平台：Windows 64位

## 主要功能

### 1. 文件处理
- 支持压缩文件（.7z, .zip, .rar）自动解压
- 支持文件夹直接处理
- 自动清理不需要的文件
- 智能文件重命名

### 2. 压缩格式
- **7z**: 高压缩率，支持固实压缩
- **zip**: 通用格式，兼容性好
- **zst**: 双层压缩（内层7z+外层zstd），最高压缩率
  - 文件名格式：`文件名.7z.zst`

### 3. 图片处理
- 支持多种图片格式输入（JPG, PNG, BMP, TIFF等）
- 自动跳过GIF文件（保留原始GIF）
- 压缩格式选择：
  - **WebP**: 平衡的压缩率和速度，兼容性好（默认）
  - **AVIF**: 更高压缩率，文件更小，但编码较慢
- 可配置图片尺寸和质量

### 4. 灵活的处理选项
- **跳过登录**: 完全离线使用，只执行本地处理
- **启用上传**: 控制是否上传图片到服务器
- **发布文章**: 控制是否创建文章（可以只上传不发布）
- **保留压缩图片**: 压缩后的图片保存到 `_compressed` 文件夹
- **删除源文件**: 处理完成后自动删除原始文件

### 5. 自动分类匹配
- 自动从API获取分类列表
- 根据文件名智能匹配coser分类
- 自动使用对应的categoryId

## 使用方法

### 基本使用
1. 运行 `文件处理工具.exe`
2. 设置输出目录
3. 拖拽压缩文件或文件夹到窗口
4. 配置处理选项
5. 点击"开始处理"

### 离线模式
1. 勾选"跳过登录"
2. 不需要填写账号密码
3. 只执行本地处理（解压、重命名、打包、压缩图片）

### 在线模式
1. 填写登录账号和密码
2. 可选择是否上传和发布
3. 支持自动分类匹配

## 配置说明

### 主界面配置
- 输出目录：处理后文件的保存位置
- 登录信息：账号、密码、设备ID
- 跳过登录：离线模式开关
- 压缩格式：7z / zip / zst
- 压缩级别：0-9（9为最高）
- 固实压缩：提高压缩率
- 字典大小：影响压缩率和内存使用
- 删除源文件：处理完成后删除原始文件
- 删除压缩图片：不保留压缩后的图片
- 启用上传：是否上传到服务器
- 发布文章：是否创建文章

### 高级配置
点击"高级配置"按钮可以设置：

**文件处理**
- 图片文件前缀
- 视频文件前缀
- 压缩包密码
- 解压密码列表

**图片压缩**
- 最大高度/宽度
- 图片质量（1-100）
- 压缩格式（WebP / AVIF）

**API配置**
- 上传API地址
- 文章API地址
- 登录API地址
- 分类API地址
- 上传批次大小
- API超时时间

**系统配置**
- 最大重试次数
- 解压超时时间
- 日志保留天数

## 处理模式

### 离线模式
- 跳过登录：✓
- 用途：完全离线处理，不需要网络

### 完整模式（默认）
- 跳过登录：✗
- 启用上传：✓
- 发布文章：✓
- 流程：解压 → 重命名 → 打包 → 压缩图片 → 上传 → 创建文章

### 只上传不发布
- 启用上传：✓
- 发布文章：✗
- 用途：图片上传到服务器，手动创建文章

### 仅打包模式
- 启用上传：✗
- 用途：只整理和打包文件

### 保留压缩图片模式
- 删除压缩图片：✗
- 结果：生成 `文件名_compressed` 文件夹

## 系统要求

### 必需工具
1. **7-Zip**: 用于解压和压缩
   - 下载：https://www.7-zip.org/
   - 放置位置：
     - `tools/7z/7z.exe`
     - 或安装到系统PATH

2. **FFmpeg**: 用于图片和视频处理
   - 下载：https://github.com/BtbN/FFmpeg-Builds/releases
   - 放置位置：
     - `tools/ffmpeg/bin/ffmpeg.exe`（推荐）
     - `tools/ffmpeg/ffmpeg.exe`
     - 或安装到系统PATH

### 运行环境
- Windows 10/11 64位
- 至少2GB可用内存
- 足够的磁盘空间用于临时文件

## 注意事项

1. **首次运行**
   - 确保7-Zip和FFmpeg已正确安装
   - 设置输出目录
   - 如果使用在线功能，填写登录信息

2. **文件处理**
   - 支持的压缩格式：.7z, .zip, .rar, .tar, .gz
   - GIF文件会被保留原样，不会被压缩
   - 原图保留在压缩包中，压缩图片用于上传

3. **zst格式**
   - 需要7-Zip 21.07或更高版本
   - 生成的文件名为 `.7z.zst`
   - 解压时先解压zst得到7z，再解压7z

4. **AVIF格式**
   - 需要FFmpeg支持libaom-av1编码器
   - 压缩速度较慢，但文件更小
   - 建议用于对文件大小敏感的场景

## 故障排除

### 工具未找到
- 检查tools目录是否包含7z.exe和ffmpeg.exe
- 或将工具安装到系统PATH

### 登录失败
- 检查账号密码是否正确
- 检查网络连接
- 或勾选"跳过登录"使用离线模式

### 压缩失败
- 检查磁盘空间是否充足
- 检查输出目录是否有写入权限
- 查看日志文件了解详细错误

### 上传失败
- 检查网络连接
- 检查API地址是否正确
- 查看日志文件了解详细错误

## 更新日志

详见 `CHANGELOG.md`

## 技术支持

如有问题，请查看：
- `README.md` - 详细使用说明
- `CHANGELOG.md` - 更新历史
- `logs/` 目录 - 运行日志
